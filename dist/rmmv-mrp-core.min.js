!function e(t,n,r){function o(i,u){if(!n[i]){if(!t[i]){var c="function"==typeof require&&require;if(!u&&c)return c(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var s=n[i]={exports:{}};t[i][0].call(s.exports,function(e){var n=t[i][1][e];return o(n?n:e)},s,s.exports,e,t,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t,n){!function(e){"use strict";var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,n=e.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),r=n&&e.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),o=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,a=(n||o)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var t,a,i,u,c,l;for(t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):decodeURIComponent(e.split(",")[1]),a=new ArrayBuffer(t.length),i=new Uint8Array(a),u=0;u<t.length;u+=1)i[u]=t.charCodeAt(u);return c=e.split(",")[0].split(":")[1].split(";")[0],n?new Blob([r?i:a],{type:c}):(l=new o,l.append(a),l.getBlob(c))};e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(e,n,r){e(r&&t.toDataURL&&a?a(this.toDataURL(n,r)):this.mozGetAsFile("blob",n))}:t.toDataURL&&a&&(t.toBlob=function(e,t,n){e(a(this.toDataURL(t,n)))})),"function"==typeof define&&define.amd?define(function(){return a}):e.dataURLtoBlob=a}(window)},{}],2:[function(e,t,n){var r=r||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in r,a=function(e){var t=new MouseEvent("click");e.dispatchEvent(t)},i=e.webkitRequestFileSystem,u=e.requestFileSystem||i||e.mozRequestFileSystem,c=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},l="application/octet-stream",s=0,f=500,p=function(t){var r=function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()};e.chrome?r():setTimeout(r,f)},d=function(e,t,n){t=[].concat(t);for(var r=t.length;r--;){var o=e["on"+t[r]];if("function"==typeof o)try{o.call(e,n||e)}catch(a){c(a)}}},v=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e},m=function(t,c,f){f||(t=v(t));var m,g,y,h=this,b=t.type,w=!1,_=function(){d(h,"writestart progress write writeend".split(" "))},O=function(){if((w||!m)&&(m=n().createObjectURL(t)),g)g.location.href=m;else{var r=e.open(m,"_blank");void 0==r&&"undefined"!=typeof safari&&(e.location.href=m)}h.readyState=h.DONE,_(),p(m)},x=function(e){return function(){return h.readyState!==h.DONE?e.apply(this,arguments):void 0}},E={create:!0,exclusive:!1};return h.readyState=h.INIT,c||(c="download"),o?(m=n().createObjectURL(t),r.href=m,r.download=c,void setTimeout(function(){a(r),_(),p(m),h.readyState=h.DONE})):(e.chrome&&b&&b!==l&&(y=t.slice||t.webkitSlice,t=y.call(t,0,t.size,l),w=!0),i&&"download"!==c&&(c+=".download"),(b===l||i)&&(g=e),u?(s+=t.size,void u(e.TEMPORARY,s,x(function(e){e.root.getDirectory("saved",E,x(function(e){var n=function(){e.getFile(c,E,x(function(e){e.createWriter(x(function(n){n.onwriteend=function(t){g.location.href=e.toURL(),h.readyState=h.DONE,d(h,"writeend",t),p(e)},n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&O()},"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=h["on"+e]}),n.write(t),h.abort=function(){n.abort(),h.readyState=h.DONE},h.readyState=h.WRITING}),O)}),O)};e.getFile(c,{create:!1},x(function(e){e.remove(),n()}),x(function(e){e.code===e.NOT_FOUND_ERR?n():O()}))}),O)}),O)):void O())},g=m.prototype,y=function(e,t,n){return new m(e,t,n)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return n||(e=v(e)),navigator.msSaveOrOpenBlob(e,t||"download")}:(g.abort=function(){var e=this;e.readyState=e.DONE,d(e,"abort")},g.readyState=g.INIT=0,g.WRITING=1,g.DONE=2,g.error=g.onwritestart=g.onprogress=g.onwrite=g.onabort=g.onerror=g.onwriteend=null,y)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof t&&t.exports?t.exports.saveAs=r:"undefined"!=typeof define&&null!==define&&null!=define.amd&&define([],function(){return r})},{}],3:[function(e,t,n){"use strict";var r,o,a,i,u,c,l,s=e("d"),f=e("es5-ext/object/valid-callable"),p=Function.prototype.apply,d=Function.prototype.call,v=Object.create,m=Object.defineProperty,g=Object.defineProperties,y=Object.prototype.hasOwnProperty,h={configurable:!0,enumerable:!1,writable:!0};r=function(e,t){var n;return f(t),y.call(this,"__ee__")?n=this.__ee__:(n=h.value=v(null),m(this,"__ee__",h),h.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},o=function(e,t){var n,o;return f(t),o=this,r.call(this,e,n=function(){a.call(o,e,n),p.call(t,this,arguments)}),n.__eeOnceListener__=t,this},a=function(e,t){var n,r,o,a;if(f(t),!y.call(this,"__ee__"))return this;if(n=this.__ee__,!n[e])return this;if(r=n[e],"object"==typeof r)for(a=0;o=r[a];++a)(o===t||o.__eeOnceListener__===t)&&(2===r.length?n[e]=r[a?0:1]:r.splice(a,1));else(r===t||r.__eeOnceListener__===t)&&delete n[e];return this},i=function(e){var t,n,r,o,a;if(y.call(this,"__ee__")&&(o=this.__ee__[e]))if("object"==typeof o){for(n=arguments.length,a=new Array(n-1),t=1;n>t;++t)a[t-1]=arguments[t];for(o=o.slice(),t=0;r=o[t];++t)p.call(r,this,a)}else switch(arguments.length){case 1:d.call(o,this);break;case 2:d.call(o,this,arguments[1]);break;case 3:d.call(o,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,a=new Array(n-1),t=1;n>t;++t)a[t-1]=arguments[t];p.call(o,this,a)}},u={on:r,once:o,off:a,emit:i},c={on:s(r),once:s(o),off:s(a),emit:s(i)},l=g({},c),t.exports=n=function(e){return null==e?v(l):g(Object(e),c)},n.methods=u},{d:4,"es5-ext/object/valid-callable":13}],4:[function(e,t,n){"use strict";var r,o=e("es5-ext/object/assign"),a=e("es5-ext/object/normalize-options"),i=e("es5-ext/object/is-callable"),u=e("es5-ext/string/#/contains");r=t.exports=function(e,t){var n,r,i,c,l;return arguments.length<2||"string"!=typeof e?(c=t,t=e,e=null):c=arguments[2],null==e?(n=i=!0,r=!1):(n=u.call(e,"c"),r=u.call(e,"e"),i=u.call(e,"w")),l={value:t,configurable:n,enumerable:r,writable:i},c?o(a(c),l):l},r.gs=function(e,t,n){var r,c,l,s;return"string"!=typeof e?(l=n,n=t,t=e,e=null):l=arguments[3],null==t?t=void 0:i(t)?null==n?n=void 0:i(n)||(l=n,n=void 0):(l=t,t=n=void 0),null==e?(r=!0,c=!1):(r=u.call(e,"c"),c=u.call(e,"e")),s={get:t,set:n,configurable:r,enumerable:c},l?o(a(l),s):s}},{"es5-ext/object/assign":5,"es5-ext/object/is-callable":8,"es5-ext/object/normalize-options":12,"es5-ext/string/#/contains":15}],5:[function(e,t,n){"use strict";t.exports=e("./is-implemented")()?Object.assign:e("./shim")},{"./is-implemented":6,"./shim":7}],6:[function(e,t,n){"use strict";t.exports=function(){var e,t=Object.assign;return"function"!=typeof t?!1:(e={foo:"raz"},t(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},{}],7:[function(e,t,n){"use strict";var r=e("../keys"),o=e("../valid-value"),a=Math.max;t.exports=function(e,t){var n,i,u,c=a(arguments.length,2);for(e=Object(o(e)),u=function(r){try{e[r]=t[r]}catch(o){n||(n=o)}},i=1;c>i;++i)t=arguments[i],r(t).forEach(u);if(void 0!==n)throw n;return e}},{"../keys":9,"../valid-value":14}],8:[function(e,t,n){"use strict";t.exports=function(e){return"function"==typeof e}},{}],9:[function(e,t,n){"use strict";t.exports=e("./is-implemented")()?Object.keys:e("./shim")},{"./is-implemented":10,"./shim":11}],10:[function(e,t,n){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},{}],11:[function(e,t,n){"use strict";var r=Object.keys;t.exports=function(e){return r(null==e?e:Object(e))}},{}],12:[function(e,t,n){"use strict";var r=Array.prototype.forEach,o=Object.create,a=function(e,t){var n;for(n in e)t[n]=e[n]};t.exports=function(e){var t=o(null);return r.call(arguments,function(e){null!=e&&a(Object(e),t)}),t}},{}],13:[function(e,t,n){"use strict";t.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},{}],14:[function(e,t,n){"use strict";t.exports=function(e){if(null==e)throw new TypeError("Cannot use null or undefined");return e}},{}],15:[function(e,t,n){"use strict";t.exports=e("./is-implemented")()?String.prototype.contains:e("./shim")},{"./is-implemented":16,"./shim":17}],16:[function(e,t,n){"use strict";var r="razdwatrzy";t.exports=function(){return"function"!=typeof r.contains?!1:r.contains("dwa")===!0&&r.contains("foo")===!1}},{}],17:[function(e,t,n){"use strict";var r=String.prototype.indexOf;t.exports=function(e){return r.call(this,e,arguments[1])>-1}},{}],18:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}var o=e("./module/index"),a=r(o);window.MRP=a},{"./module/index":20}],19:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("event-emitter"),a=r(o),i=(0,a["default"])({}),u=Game_Troop.prototype.onBattleEnd;Game_Troop.prototype.onBattleEnd=function(){i.emit("battle.end"),u.call(this)};var c=Game_Troop.prototype.onBattleStart;Game_Troop.prototype.onBattleStart=function(){i.emit("battle.start"),c.call(this)};var l=BattleManager.endTurn.bind(BattleManager);BattleManager.endTurn=function(){l(),i.emit("turn.end")};var s=BattleManager.startTurn.bind(BattleManager);BattleManager.startTurn=function(){s(),i.emit("turn.start")},n["default"]=i},{"event-emitter":3}],20:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0}),n.MapExporter=n.OptionParser=n.BattleObserver=void 0;var a=e("./battle-observer"),i=o(a),u=e("./option-parser"),c=r(u),l=e("./map-exporter"),s=o(l);n.BattleObserver=i["default"],n.OptionParser=c,n.MapExporter=s["default"]},{"./battle-observer":19,"./map-exporter":21,"./option-parser":22}],21:[function(e,t,n){"use strict";function r(e,t,n){var r=e*u,o=t*c,a=r*i,l=o*i;$gameMap._displayX=r,$gameMap._displayY=o,SceneManager.update();var s=SceneManager.snap()._canvas;n.getContext("2d").drawImage(s,a,l)}function o(){var e=$dataMap.width*i,t=$dataMap.height*i,n=Math.ceil(e/SceneManager._screenWidth),o=Math.ceil(t/SceneManager._screenHeight),u=document.createElement("canvas");u.width=e,u.height=t;var c=$gamePlayer._opacity;$gamePlayer._opacity=0;var l=0,s=0;for(l=0;n>l;l++)for(s=0;o>s;s++)r(l,s,u);$gamePlayer._opacity=c,u.toBlob(function(e){a(e,"map.png")})}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=o,e("blueimp-canvas-to-blob");var a=e("browser-filesaver").saveAs,i=48,u=17,c=13},{"blueimp-canvas-to-blob":1,"browser-filesaver":2}],22:[function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function a(e){for(var t,n,r,a={args:[]};t=i(e);){var u=t,c=b(u,2);if(n=c[0],r=c[1],"object"===("undefined"==typeof n?"undefined":o(n))){a=h({},a,n);var l=r.ofType("COMMA"),s=r.ofType("KEY")&&r.advance().ofType("KEYVALSEP");if(l)e=r.advance();else{if(!s)return[a,r];e=r}}else{if(a=h({},a,{args:a.args.concat(n)}),r.empty||"COMMA"!=r.get().type)return[a,r];e=r.advance()}}return[a,e]}function i(e){return u(e)||c(e)}function u(e){if(e.length<3)return null;if(!e.ofType("KEY")||!e.advance().ofType("KEYVALSEP"))return null;var t=c(e.advance(2));return t?[r({},e.get().token,t[0]),e.advance(3)]:null}function c(e){if(e.empty)return null;var t=e.get();switch(t.type){case"NUMBER":return[Number(t.token),e.advance()];case"BARESTRING":case"KEY":return[t.token,e.advance()];case"BOOLEAN":return["true"===t.token.toLowerCase()?!0:!1,e.advance()];default:return null}}function l(e){if(e.length<3)return null;if(!e.ofType("BRA"))return null;var t=a(e.advance());if(!t)return null;var n=b(t,2),r=n[0],o=n[1];return o.ofType("KET")?[r,o.advance()]:null}function s(e){if(e.length<3)return null;var t=e.advance();if(!e.ofType("BRA")||!t.ofType("IDENTIFIER"))return null;var n=a(e.advance(2));if(!n)return null;var r=b(n,2),o=r[0],i=r[1];return i.ofType("KET")?[h({},o,{type:t.get().token}),i.advance()]:null}function f(e){return l(e)||s(e)}function p(e){var t=f(e);return t?t[0]:null}function d(e){return p((0,w.TokenStream)(C(e)))}function v(e){for(var t=(0,w.TokenStream)(C(e)),n=[];t.present;){var r=f(t);r?(n.push(r[0]),t=r[1]):t=t.advance()}return n}function m(e){return function(t){for(var n=(0,w.TokenStream)(C(t));n.present;){var r=f(n);if(r&&e(r[0]))return r[0];n=n.advance()}return null}}function g(e,t){return m(function(e){return e.type===t})(e)}function y(e,t){return v(e).filter(function(e){return e.type===t})}var h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(c){o=!0,a=c}finally{try{!r&&u["return"]&&u["return"]()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Object.defineProperty(n,"__esModule",{value:!0}),n.extractFirst=void 0,n.parse=d,n.extractAll=v,n.extractFirstOfType=g,n.extractAllOfType=y;var w=e("./lexer-utils"),_=(0,w.regex)("BRA",/</),O=(0,w.regex)("KET",/>/),x=(0,w.skip)((0,w.regex)("WHITESPACE",/\s+/)),E=(0,w.regex)("IDENTIFIER",/[a-zA-Z_][a-zA-Z0-9-_]*/),S=(0,w.regex)("KEY",/[a-zA-Z_][a-zA-Z0-9-_]*/),T=(0,w.regex)("KEYVALSEP",/:/),B=((0,w.seq)(S,(0,w.optional)(x),T),(0,w.regex)("SIGNIFICANT_WHITESPACE",/\s+/)),A=(0,w.regex)("BAREWORD",/[^,:><"\s]+/),k=(0,w.concat)("BARESTRING",(0,w.seq)(A,(0,w.repeat)((0,w.notFollowedBy)((0,w.seq)(B,A),(0,w.seq)((0,w.optional)(x),T))))),M=(0,w.regex)("COMMA",/,/),j=(0,w.regex)("NUMBER",/-?[0-9]+(\.[0-9]+)?/),R=(0,w.regex)("BOOLEAN",/(true|false)/,"i"),N=(0,w.map)(JSON.parse,(0,w.regex)("BARESTRING",/"([^"]|\\")*"/)),C=(0,w.Lexer)((0,w.or)(x,_,O,M,(0,w.seq)(S,(0,w.optional)(x),T),(0,w.seq)((0,w.precededByToken)("BRA"),(0,w.optional)(x),(0,w.notFollowedBy)(E,M)),T,j,R,N,k));n.extractFirst=m(function(){return!0})},{"./lexer-utils":23}],23:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t,n){return{type:e,token:t,pos:n}}function a(e,t){return{tokens:e,newCharacterStream:t}}function i(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return{buffer:e,pos:t,length:e.length-t,present:t<e.length,empty:t>=e.length,rest:function(){return e.slice(t)},get:function(){return e[t]},advance:function(){var n=arguments.length<=0||void 0===arguments[0]?1:arguments[0];return i(e,t+n)},take:function(n){return e.slice(t,t+n)}}}function u(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return _({},i(e,t),{advance:function(){var n=arguments.length<=0||void 0===arguments[0]?1:arguments[0];return u(e,t+n)},flush:function(){return u(e,e.length)},Token:function(e,n){return o(e,n,t)}})}function c(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return _({},i(e,t),{advance:function(){var n=arguments.length<=0||void 0===arguments[0]?1:arguments[0];return c(e,t+n)},ofType:function(n){return t<e.length&&e[t].type===n}})}function l(e,t){var n=arguments.length<=2||void 0===arguments[2]?"":arguments[2],r=new RegExp(/^/.source+t.source,n);return function(t,n){var o;return(o=n.rest().match(r))?a([n.Token(e,o[0])],n.advance(o[0].length)):null}}function s(e){return function(t,n){var r;return(r=e(t,n))?a([],r.newCharacterStream):null}}function f(e){return function(t,n){var r;return(r=e(t,n))?a([],r.newCharacterStream):a([],n)}}function p(e,t){return function(n,o){var i=e(n,o);if(!i)return null;var u=t([].concat(r(n),r(i.tokens)),i.newCharacterStream);return u?a([].concat(r(i.tokens),r(u.tokens)),u.newCharacterStream):null}}function d(e,t,n){var r=p(e,t);if(n){for(var o=arguments.length,a=Array(o>3?o-3:0),i=3;o>i;i++)a[i-3]=arguments[i];return d.apply(void 0,[r,n].concat(a))}return r}function v(e){return function(t,n){var r=t[t.length-1];return r&&r.type==e?a([],n):null}}function m(e,t){return function(n,r){var i;if(i=t(n,r)){var u=i.tokens.map(function(t){var n=t.type,r=t.token,a=t.pos;return o(n,e(r),a)});return a(u,i.newCharacterStream)}return null}}function g(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return function(e,n){for(var r,o=0;o<t.length;o++)if(r=t[o](e,n))return r;return null}}function y(e){return function(t,n){for(var o=[],i=0;n.present;){var u=e(o,n);if(!u)break;if(o=[].concat(r(o),r(u.tokens)),u.newCharacterStream.pos===n.pos)return a(o,u.newCharacterStream);if(i++>1e4)throw"tried to lex more than 10,000 tokens - this is probably a bug.";n=u.newCharacterStream}return a(o,n)}}function h(e,t){return function(n,r){var o=t(n,r);if(o){var i=o.tokens.map(function(e){return e.token}).join("");return a([r.Token(e,i)],o.newCharacterStream)}return null}}function b(e,t){return function(n,o){var a=e(n,o);if(!a)return null;var i=t([].concat(r(n),r(a.tokens)),a.newCharacterStream);return i?null:a}}function w(e){return function(t){var n=u(t),r=y(g(e,l("UNKNOWN",/[^]*/)));return r([],n).tokens}}var _=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};Object.defineProperty(n,"__esModule",{value:!0}),n.CharacterStream=u,n.TokenStream=c,n.regex=l,n.skip=s,n.optional=f,n.seq=d,n.precededByToken=v,n.map=m,n.or=g,n.repeat=y,n.concat=h,n.notFollowedBy=b,n.Lexer=w,n.Token=o},{}]},{},[18]);